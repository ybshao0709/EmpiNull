% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/EmpiNull_CF_prov.R
\name{empirical_null_CF_prov}
\alias{empirical_null_CF_prov}
\title{Estimate Empirical Null Parameters with provider-level Confounding Factors}
\usage{
empirical_null_CF_prov(
  Obs,
  Exp,
  W,
  p.grid = seq(0.4, 0.999, 0.001),
  cutoff = 0.975,
  family = "poisson"
)
}
\arguments{
\item{Obs}{Numeric vector of observed counts}

\item{Exp}{Numeric vector of expected counts}

\item{W}{TBD}

\item{p.grid}{Numeric vector of candidate \eqn{p_0} values for grid search.
Default: \code{seq(0.4, 0.999, 0.001)}.}

\item{cutoff}{Numeric scalar in \code{(0,1)}; quantile used to form initial
truncation bounds. Default: \code{0.975}.}

\item{family}{Character scalar; model family. Supported:
\code{"poisson"} (default) or \code{"approx poisson"}.}
}
\value{
A list with elements:
\item{nu_hat}{Estimated coefficient vector \eqn{\hat{\nu}} (length \code{P}).}
\item{sig2_hat}{Estimated variance component \eqn{\hat{\sigma}^2}.}
\item{p0}{Selected null proportion \eqn{p_0} (grid minimum).}
\item{nu_var}{Estimated covariance matrix of \eqn{\hat{\nu}}.}
\item{W}{The centered design matrix used in fitting.}
\item{(unnamed)}{Integer indices of observations outside the truncation window
(i.e., those with \code{Z_FE < aorig} or \code{Z_FE > borig}).}
}
\description{
Estimate Empirical Null Parameters with provider-level Confounding Factors
}
