% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/EmpiNull_ind_CF.R
\name{empirical_null_ind_CF}
\alias{empirical_null_ind_CF}
\title{Estimate Individualized Empirical Null Parameters with Confounding Factors}
\usage{
empirical_null_ind_CF(
  z,
  n,
  x_bar,
  p_grid = seq(0.8, 0.999, 0.005),
  phi_grid = seq(0.01, 5, 0.01),
  cutoff = 0.95,
  sigma_est,
  range
)
}
\arguments{
\item{z}{A numeric vector of Z-scores.}

\item{n}{A numeric vector of effective sample sizes corresponding to each Z-score.}

\item{x_bar}{A numeric matrix or vector of confounders. Each row corresponds
to an observation in \code{z}.}

\item{p_grid}{A numeric vector specifying the grid of null proportions (p0)
to search. Defaults to a sequence from 0.8 to 0.999.}

\item{phi_grid}{A numeric vector specifying the grid of the variance
component (phi) to search. Defaults to a sequence from 0.01 to 5.}

\item{cutoff}{A numeric value specifying the quantile for the truncation
interval width. Defaults to 0.95.}

\item{sigma_est}{Optional. A pre-estimated standard deviation. If provided,
it defines a uniform width for the truncation interval.}

\item{range}{Optional. A parameter to define a sample-size-dependent width
for the truncation interval. Takes precedence over \code{sigma_est}.}
}
\value{
A list containing the final estimated parameters:
\item{zeta}{A numeric vector containing the estimated coefficients for the
confounders in \code{x_bar}.}
\item{phi}{The estimated variance component \code{phi}. Note: this is the raw
\code{phi}, not its square root.}
\item{p0}{The estimated null proportion \code{p0}.}
}
\description{
Estimates parameters for an individualized empirical null model that explicitly
accounts for confounding factors (\code{x_bar}).
}
