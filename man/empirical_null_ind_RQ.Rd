% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/EmpiNull_ind_RQ.R
\name{empirical_null_ind_RQ}
\alias{empirical_null_ind_RQ}
\title{Estimate Individualized Empirical Null Parameters with Random Effects}
\usage{
empirical_null_ind_RQ(
  z,
  n,
  p_grid = seq(0.8, 0.999, 0.005),
  phi_grid = seq(0.01, 5, 0.01),
  cutoff = 0.95,
  sigma_est,
  range
)
}
\arguments{
\item{z}{A numeric vector of Z-scores.}

\item{n}{A numeric vector of effective sample sizes corresponding to each Z-score.}

\item{p_grid}{A numeric vector specifying the grid of null proportions (p0)
to search. Defaults to a sequence from 0.8 to 0.999.}

\item{phi_grid}{A numeric vector specifying the grid of the variance
component (phi) to search. Defaults to a sequence from 0.01 to 5.}

\item{cutoff}{A numeric value specifying the quantile for the truncation
interval width. Defaults to 0.95.}

\item{sigma_est}{Optional. A pre-estimated standard deviation. If provided,
it defines a uniform truncation interval for all Z-scores.}

\item{range}{Optional. A parameter to define a sample-size-dependent
truncation interval. Takes precedence over \code{sigma_est}.}
}
\value{
A list containing the estimated parameters:
\item{phi}{The square root of the estimated variance component \code{phi}.}
\item{p}{The estimated null proportion \code{p0}.}
}
\description{
Estimates a null proportion (p0) and a variance component (phi) for an
individualized empirical null model. The estimation is performed via a
nested grid search over p0 and phi to minimize the negative log-likelihood.
}
\details{
The truncation interval for defining the null set is determined with the
following priority:
\enumerate{
\item If \code{range} is provided, a sample-size-dependent interval is used.
\item If \code{range} is missing but \code{sigma_est} is provided, a uniform interval is used.
\item If both are missing, \code{range} is estimated using robust regression.
}
}
